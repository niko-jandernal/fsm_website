{% extends 'base.html' %}

{% block content %}
    <link rel="stylesheet" href="../static/styles/discussionsstyle.css">
<h2>Discussions</h2>

<!-- Form for creating a new discussion post -->
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Post</button>
</form>

<div class="discussion-content">
    {% for post in discussion_posts %}
<div class="discussion-post">
    <h3>{{ post.title }}</h3>
    <p>{{ post.content }}</p>
    <small>Posted by {{ post.author.username }} on {{ post.date_posted }}</small>

    <!-- Like Button -->
    <form action="{% url 'like_post' post.id %}" method="post">
        {% csrf_token %}
        <button type="submit">{{ post.likes.count }} Like</button>
    </form>

    <!-- Display Comments -->
    {% for comment in post.comments.all %}
        <div>
            <strong>{{ comment.author.username }}:</strong>
            <p>{{ comment.content }}</p>
        </div>
    {% endfor %}

    <!-- Comment Form -->
    <form action="{% url 'post_comment' post.id %}" method="post">
        {% csrf_token %}
        <input type="text" name="comment" placeholder="Add a comment...">
        <button type="submit">Comment</button>
    </form>
</div>
{% endfor %}

</div>
{% endblock %}
